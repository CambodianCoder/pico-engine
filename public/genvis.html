<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<link rel="icon" type="image/png" href="pico-logo-transparent-48x48.png">
<title>TITLE</title>
<link rel="stylesheet" href="css/genvis.css">
<script src="js/jquery-3.1.0.min.js" type="text/javascript"></script>
<script src="js/jquery-ui-1.11.4.min.js" type="text/javascript"></script>
<script src="js/handlebars.min.js" type="text/javascript"></script>
<script src="js/genvis.js" type="text/javascript"></script>
<script id="the-template" type="text/x-handlebars-template">
<a class="logo" href="https://picolabs.io"><img src="logo.png" alt="logo"></a>
<h1 class="title">{{title}}</h1>
<div id="container" style="position:relative">
<p class="description">
{{descr}}
</p>
{{#picos}}
<div class="pico" id="{{id}}" style="{{style}}">
{{dname}}
</div>
<div class="pico-edit" style="{{style}}">
{{dname}}
<ul class="horiz-menu">
<li>About</li>
<li>Rulesets</li>
<li>Channels</li>
<li>Subscriptions</li>
<li>Logging</li>
<li>Help</li>
</ul>
<div class="pico-section"></div>
</div>
{{/picos}}
{{#if chans}}
<svg>
{{#chans}}
  <line class="{{class}}"></line>
{{/chans}}
</svg>
{{/if}}
</div>
</script>
<script id="about-template" type="text/x-handlebars-template">
<h2>Pico</h2>
<p>
<b>ID: </b>
<span id="about-pico-name">{{id}}</span>
</p>
<p>
<b>ECI: </b>
<span id="about-eci">{{eci}}</span>
</p>
<p>
<b>Note: </b>
the ECI is the path into your pico and should be treated as a
<em>shared secret</em> between the pico and the application using
the pico's Event-Query API.
Do not disclose it or check it into a repository like Github.
</p>
{{#if parent}}
<h2>Parent</h2>
<p>
<b>ID: </b>{{parent.id}}
<b>ECI: </b>{{parent.eci}}
</p>
{{/if}}
<h2>Children</h2>
{{#each children}}
<p>
<b>ID: </b>{{this.id}}
<b>ECI: </b>{{this.eci}}
</p>
{{/each}}
<p>
Manual steps to add child (pending implementation of push button automation):
</p>
<ol>
<li>create (in engine) new Pico, receiving its id</li>
<li>create (in engine) new channel for new Pico, receiving its id</li>
<li>send (this Pico) event pico/child_created</li>
<li>install ruleset io.picolabs.pico in new Pico</li>
<li>send (new Pico) event pico/child_created</li>
<li>refresh this page</li>
</ol>
<form method="GET" onsubmit="alert('not implemented');return false">
<input type="submit" value="add child pico">
</form>
</script>
<script id="rulesets-template" type="text/x-handlebars-template">
<div style="float:left;max-width:40%">
Installed Rulesets
<ul>
{{#each installed}}
<li class="krlrid">{{@key}}</li>
<ul>
{{#each vars}}
<li>ent:{{@key}}={{this}}</li>
{{/each}}
</ul>
{{/each}}
</ul>
{{#if avail}}
Available Rulesets
<p></p>
<form action="/api/pico/{{pico_id}}/add-ruleset" method="GET">
<select name="rid">
{{#each avail}}
<option>{{this}}</option>
{{/each}}
</select>
<input type="submit" value="install ruleset">
</form>
{{/if}}
</div>
<div class="krlsrc">
<form class="ruleset-compile" action="/api/ruleset/compile" method="GET">
<textarea name="src"></textarea>
<button type="submit">compile ruleset</button>
<button type="submit" formaction="/api/ruleset/register">register ruleset</button>
</form>
</div>
</script>
<script id="channels-template" type="text/x-handlebars-template">
Channels
<table border="1" cellspacing="0">
<tr><th>name</th><th>id</th><th>type</th></tr>
{{#each channel}}
<tr><td>{{name}}</td><td>{{id}}</td><td>{{type}}</td></tr>
{{/each}}
</table>
<p></p>
<form method="GET" onsubmit="alert('not implemented');return false">
<input type="text" name="name" placeholder="name...">
<input type="text" name="type" placeholder="type...">
<input type="submit" value="add channel">
</form>
</script>
<script id="subscriptions-template" type="text/x-handlebars-template">
Subscriptions
</script>
<script id="logging-template" type="text/x-handlebars-template">
Logging
</script>
<script id="help-template" type="text/x-handlebars-template">
Temporary helper for child creation
{{#each pico}}
<p>{{@index}}: {{id}} {{#each channel}}{{id}}{{/each}}</p>
{{/each}}
<form method="GET" onsubmit="this.action='http://localhost:8080/sky/event/'+(this.receiver.value==='child'?this.eci.value:this.parent_eci.value)+'/17/pico/child_created';alert(this.action)">
receiver
<input type="radio" name="receiver" value="parent">parent
<input type="radio" name="receiver" value="child">child<br>
<input type="text" name="parent_id" placeholder="parent_id..." size="40"><br>
<input type="text" name="parent_eci" placeholder="parent_eci..." size="40"><br>
<input type="text" name="id" placeholder="id..." size="40"><br>
<input type="text" name="eci" placeholder="eci..." size="40"><br>
<input type="submit" value="child_created">
</form>
</script>
</head>
<body>
<p>Loading...</p>
</body>
</html>
